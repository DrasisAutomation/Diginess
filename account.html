<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<title>DIGINESS — Account</title>
<meta name="description" content="Sign in with Google — secure & fast">
<!-- Font Awesome 6 -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<!-- Common Styles -->
<link rel="stylesheet" href="common-styles.css">
<!-- Product Data -->
<script src="product-data.js"></script>
<!-- Firebase SDK (compat) -->
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
<style>
/* Account page - complete redesign */
.account-page {
  max-width: 1200px;
  margin: calc(var(--header-h) + 40px) auto 60px;
  padding: 0 20px;
  min-height: 60vh;
}

/* ========== SIGNED OUT STYLES ========== */
.signout-container {
  max-width: 460px;
  margin: 0 auto;
  animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.signout-card {
  background: #111;
  border: 1px solid #2a2a2a;
  border-radius: 32px;
  padding: 48px 40px;
  text-align: center;
  box-shadow: 0 30px 60px rgba(0,0,0,0.5);
}

.signout-icon {
  width: 100px;
  height: 100px;
  background: #1a1a1a;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 24px;
  border: 2px solid #2a2a2a;
}

.signout-icon i {
  font-size: 48px;
  color: var(--primary);
}

.signout-card h1 {
  font-size: 28px;
  font-weight: 300;
  letter-spacing: .2em;
  color: #fff;
  margin-bottom: 16px;
}

.signout-card p {
  color: #888;
  font-size: 14px;
  margin-bottom: 32px;
  line-height: 1.6;
}

.signout-divider {
  display: flex;
  align-items: center;
  gap: 16px;
  margin: 32px 0;
  color: #444;
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: .1em;
}

.signout-divider::before,
.signout-divider::after {
  content: '';
  flex: 1;
  height: 1px;
  background: #2a2a2a;
}

.google-signin-btn {
  width: 100%;
  background: #fff;
  border: 1px solid #dadce0;
  border-radius: 48px;
  padding: 16px 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  font-size: 15px;
  font-weight: 500;
  color: #3c4043;
  transition: all 0.3s;
  margin-bottom: 20px;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.google-signin-btn i {
  font-size: 24px;
  color: #4285f4;
}

.google-signin-btn:hover {
  background: #f8f9fa;
  border-color: #4285f4;
  box-shadow: 0 4px 12px rgba(66,133,244,0.2);
  transform: translateY(-2px);
}

.signout-features {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
  margin-top: 32px;
  padding-top: 32px;
  border-top: 1px solid #2a2a2a;
}

.feature-item {
  text-align: center;
}

.feature-item i {
  font-size: 20px;
  color: var(--primary);
  margin-bottom: 8px;
}

.feature-item span {
  font-size: 11px;
  color: #888;
  display: block;
  text-transform: uppercase;
  letter-spacing: .1em;
}

.signout-footer {
  margin-top: 24px;
  color: #666;
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: .1em;
}

.signout-footer a {
  color: var(--primary);
  text-decoration: none;
  margin-left: 8px;
}

.signout-footer a:hover {
  text-decoration: underline;
}

/* ========== SIGNED IN STYLES ========== */
.welcome-banner {
  background: linear-gradient(145deg, #111 0%, #1a1a1a 100%);
  border: 1px solid #2a2a2a;
  border-radius: 24px;
  padding: 32px 40px;
  margin-bottom: 40px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 24px;
  animation: slideDown 0.5s ease;
}

@keyframes slideDown {
  from { opacity: 0; transform: translateY(-20px); }
  to { opacity: 1; transform: translateY(0); }
}

.welcome-content {
  display: flex;
  align-items: center;
  gap: 24px;
  flex-wrap: wrap;
}

.profile-image-large {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid var(--primary);
  background: #2a2a2a;
}

.profile-image-large i {
  font-size: 40px;
  color: #666;
}

.welcome-text h1 {
  font-size: 24px;
  font-weight: 300;
  letter-spacing: .15em;
  margin-bottom: 8px;
  color: #fff;
}

.welcome-text .user-email {
  font-size: 14px;
  color: #888;
  display: flex;
  align-items: center;
  gap: 8px;
}

.welcome-text .user-email i {
  color: var(--primary);
  font-size: 14px;
}

.welcome-actions {
  display: flex;
  gap: 12px;
}

.btn-outline-light {
  padding: 12px 24px;
  font-size: 11px;
  letter-spacing: .12em;
  text-transform: uppercase;
  border: 1px solid #3a3a3a;
  background: transparent;
  color: #fff;
  transition: all .2s;
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  border-radius: 40px;
}

.btn-outline-light:hover {
  border-color: var(--primary);
  color: var(--primary);
}

.btn-primary-white {
  background: var(--primary);
  color: #000;
  padding: 12px 24px;
  font-size: 11px;
  letter-spacing: .12em;
  text-transform: uppercase;
  border: none;
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  border-radius: 40px;
  font-weight: 500;
  text-decoration: none;
}

.btn-primary-white:hover {
  opacity: 0.8;
  background: #ffffff;
}

/* Stats Cards */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  margin-bottom: 48px;
}

.stat-card {
  background: #111;
  border: 1px solid #2a2a2a;
  border-radius: 20px;
  padding: 24px;
  display: flex;
  align-items: center;
  gap: 16px;
  transition: all 0.3s;
}

.stat-card:hover {
  border-color: var(--primary);
  transform: translateY(-2px);
}

.stat-icon {
  width: 48px;
  height: 48px;
  background: #1a1a1a;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid #333;
}

.stat-icon i {
  font-size: 20px;
  color: var(--primary);
}

.stat-info h3 {
  font-size: 20px;
  font-weight: 400;
  color: #fff;
  margin-bottom: 4px;
}

.stat-info p {
  font-size: 12px;
  color: #888;
  letter-spacing: .1em;
}

/* Orders Section */
.orders-section {
  background: #111;
  border: 1px solid #2a2a2a;
  border-radius: 24px;
  padding: 32px;
  margin-bottom: 40px;
  animation: fadeIn 0.5s ease;
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 32px;
  flex-wrap: wrap;
  gap: 16px;
}

.section-header h2 {
  font-size: 18px;
  letter-spacing: .2em;
  color: var(--primary);
  font-weight: 300;
  display: flex;
  align-items: center;
  gap: 10px;
}

.section-header h2 i {
  font-size: 20px;
}

.filter-tabs {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.filter-tab {
  padding: 8px 16px;
  font-size: 11px;
  letter-spacing: .1em;
  background: #1a1a1a;
  border: 1px solid #333;
  color: #888;
  cursor: pointer;
  transition: all 0.2s;
  border-radius: 30px;
}

.filter-tab.active {
  background: var(--primary);
  color: #000;
  border-color: var(--primary);
}

.filter-tab:hover:not(.active) {
  border-color: var(--primary);
  color: #fff;
}

/* Orders List */
.orders-list {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.order-group {
  background: #1a1a1a;
  border: 1px solid #2a2a2a;
  border-radius: 20px;
  overflow: hidden;
  animation: slideIn 0.5s ease;
}

@keyframes slideIn {
  from { opacity: 0; transform: translateX(-20px); }
  to { opacity: 1; transform: translateX(0); }
}

.order-group-header {
  background: #222;
  padding: 16px 24px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 16px;
  border-bottom: 1px solid #333;
}

.order-group-info {
  display: flex;
  align-items: center;
  gap: 24px;
  flex-wrap: wrap;
}

.order-group-id {
  font-size: 13px;
  color: var(--primary);
  letter-spacing: .1em;
  font-weight: 500;
}

.order-group-date {
  font-size: 11px;
  color: #888;
  display: flex;
  align-items: center;
  gap: 6px;
}

.order-group-date i {
  font-size: 12px;
  color: #666;
}

.order-group-status {
  padding: 4px 12px;
  background: #2a2a2a;
  border-radius: 30px;
  font-size: 10px;
  color: #aaa;
  text-transform: uppercase;
  letter-spacing: .1em;
  border: 1px solid #3a3a3a;
}

.order-group-total {
  font-size: 14px;
  color: #fff;
}

.order-group-total span {
  color: var(--primary);
  font-weight: 500;
  margin-left: 8px;
}

/* Order Items */
.order-items {
  padding: 20px 24px;
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.order-item {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 12px;
  background: #1f1f1f;
  border-radius: 12px;
  border: 1px solid #2a2a2a;
  transition: all 0.2s;
}

.order-item:hover {
  border-color: #444;
}

.order-item-img {
  width: 60px;
  height: 80px;
  object-fit: cover;
  border-radius: 8px;
  border: 1px solid #333;
}

.order-item-details {
  flex: 1;
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 12px;
}

.order-item-info h4 {
  font-size: 12px;
  letter-spacing: .1em;
  margin-bottom: 6px;
  color: #fff;
  font-weight: 400;
}

.order-item-info .item-price {
  font-size: 11px;
  color: #888;
}

.order-item-meta {
  display: flex;
  align-items: center;
  gap: 24px;
}

.order-item-quantity {
  font-size: 11px;
  color: #888;
  background: #2a2a2a;
  padding: 4px 10px;
  border-radius: 30px;
}

.order-item-total {
  font-size: 12px;
  color: var(--primary);
  font-weight: 500;
  min-width: 80px;
  text-align: right;
}

/* Order Footer */
.order-group-footer {
  padding: 16px 24px;
  background: #222;
  border-top: 1px solid #333;
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 16px;
}

.order-summary {
  display: flex;
  align-items: center;
  gap: 24px;
  flex-wrap: wrap;
}

.order-summary-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 11px;
  color: #888;
}

.order-summary-item i {
  color: var(--primary);
  font-size: 12px;
}

.btn-track {
  padding: 10px 24px;
  font-size: 11px;
  letter-spacing: .12em;
  text-transform: uppercase;
  border: 1px solid var(--primary);
  background: transparent;
  color: var(--primary);
  transition: all .2s;
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  border-radius: 40px;
}

.btn-track:hover {
  background: rgba(255,255,255,0.15);
  color: #fff;
}

.btn-track i {
  font-size: 12px;
}

/* No Orders State */
.no-orders {
  text-align: center;
  padding: 80px 20px;
  background: #1a1a1a;
  border-radius: 20px;
  border: 1px dashed #333;
}

.no-orders-icon {
  width: 80px;
  height: 80px;
  background: #222;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 24px;
  border: 1px solid #333;
}

.no-orders-icon i {
  font-size: 32px;
  color: var(--primary);
  opacity: 0.5;
}

.no-orders h3 {
  font-size: 18px;
  font-weight: 300;
  letter-spacing: .15em;
  margin-bottom: 12px;
  color: #fff;
}

.no-orders p {
  color: #888;
  font-size: 13px;
  margin-bottom: 32px;
  max-width: 400px;
  margin-left: auto;
  margin-right: auto;
}

.btn-shop-large {
  background: var(--primary);
  color: #000;
  padding: 16px 40px;
  font-size: 12px;
  letter-spacing: .15em;
  text-transform: uppercase;
  border: none;
  cursor: pointer;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  gap: 12px;
  border-radius: 40px;
  font-weight: 500;
}

.btn-shop-large:hover {
  opacity: 0.8;
  background: #ffffff;
}

/* Track Modal */
.track-modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.95);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  opacity: 0;
  transition: opacity 0.3s ease;
  padding: 20px;
}

.track-modal.active {
  display: flex;
  opacity: 1;
}

.track-modal-content {
  background: #111;
  border: 1px solid #2a2a2a;
  border-radius: 32px;
  padding: 40px;
  max-width: 480px;
  width: 100%;
  position: relative;
  animation: modalSlideUp 0.4s ease;
  box-shadow: 0 30px 60px rgba(0,0,0,0.5);
}

@keyframes modalSlideUp {
  from {
    transform: translateY(30px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.modal-close {
  position: absolute;
  top: 20px;
  right: 20px;
  background: #1a1a1a;
  border: 1px solid #333;
  color: #888;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s;
  font-size: 16px;
}

.modal-close:hover {
  border-color: var(--primary);
  color: var(--primary);
  background: #222;
}

.modal-icon {
  text-align: center;
  margin-bottom: 24px;
}

.modal-icon i {
  font-size: 64px;
  color: var(--primary);
  opacity: 0.8;
}

.modal-title {
  font-size: 20px;
  letter-spacing: .2em;
  text-align: center;
  margin-bottom: 16px;
  color: #fff;
  font-weight: 300;
}

.modal-message {
  text-align: center;
  color: #aaa;
  font-size: 14px;
  line-height: 1.8;
  margin-bottom: 32px;
  padding: 0 20px;
}

.modal-order-info {
  background: #1a1a1a;
  border-radius: 16px;
  padding: 24px;
  margin-bottom: 32px;
  border: 1px solid #2a2a2a;
}

.modal-order-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
  padding-bottom: 12px;
  border-bottom: 1px solid #2a2a2a;
}

.modal-order-row:last-child {
  margin-bottom: 0;
  padding-bottom: 0;
  border-bottom: none;
}

.modal-order-label {
  font-size: 11px;
  color: #888;
  text-transform: uppercase;
  letter-spacing: .1em;
}

.modal-order-value {
  font-size: 13px;
  color: var(--primary);
  font-weight: 500;
}

.modal-order-status-badge {
  display: inline-block;
  padding: 4px 12px;
  background: #222;
  border: 1px solid #333;
  border-radius: 30px;
  font-size: 10px;
  color: #aaa;
  text-transform: uppercase;
}

.modal-btn {
  background: var(--primary);
  color: #000;
  padding: 16px 32px;
  font-size: 12px;
  letter-spacing: .15em;
  text-transform: uppercase;
  border: none;
  width: 100%;
  cursor: pointer;
  font-weight: 500;
  border-radius: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  transition: all 0.3s;
}

.modal-btn:hover {
  opacity: 0.8;
  background: #ffffff;
}

/* Loading State */
.loading-orders {
  text-align: center;
  padding: 80px;
  background: #111;
  border: 1px solid #2a2a2a;
  border-radius: 24px;
  color: #888;
}

.loading-orders i {
  font-size: 48px;
  color: var(--primary);
  margin-bottom: 20px;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.loading-orders p {
  font-size: 14px;
  letter-spacing: .15em;
}

/* Auth Message */
.auth-message {
  font-size: 12px;
  color: #ff6b6b;
  margin-top: 16px;
  min-height: 20px;
}

/* Responsive */
@media (max-width: 900px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .order-group-header {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .order-group-info {
    width: 100%;
    justify-content: space-between;
  }
  
  .signout-features {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 768px) {
  .welcome-banner {
    padding: 24px;
  }
  
  .welcome-content {
    flex-direction: column;
    text-align: center;
    width: 100%;
  }
  
  .welcome-actions {
    width: 100%;
    flex-direction: column;
  }
  
  .stats-grid {
    grid-template-columns: 1fr;
  }
  
  .orders-section {
    padding: 20px;
  }
  
  .order-item {
    flex-wrap: wrap;
  }
  
  .order-item-img {
    width: 80px;
    height: 100px;
  }
  
  .order-item-details {
    flex: 1 1 100%;
  }
  
  .order-item-meta {
    width: 100%;
    justify-content: space-between;
  }
  
  .order-group-footer {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .order-summary {
    width: 100%;
    justify-content: space-between;
  }
  
  .btn-track {
    width: 100%;
    justify-content: center;
  }
  
  .signout-card {
    padding: 32px 20px;
  }
  
  .signout-card h1 {
    font-size: 24px;
  }
  
  .signout-features {
    grid-template-columns: 1fr;
    gap: 20px;
  }
}

@media (max-width: 480px) {
  .account-page {
    padding: 0 12px;
  }
  
  .welcome-banner {
    padding: 20px;
  }
  
  .profile-image-large {
    width: 60px;
    height: 60px;
  }
  
  .welcome-text h1 {
    font-size: 20px;
  }
  
  .order-group-info {
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
  }
  
  .order-summary {
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
  }
  
  .track-modal-content {
    padding: 30px 20px;
  }
  
  .modal-icon i {
    font-size: 48px;
  }
  
  .modal-title {
    font-size: 18px;
  }
  
  .signout-card {
    padding: 24px 16px;
  }
  
  .signout-icon {
    width: 80px;
    height: 80px;
  }
  
  .signout-icon i {
    font-size: 36px;
  }
  
  .google-signin-btn {
    padding: 14px 20px;
    font-size: 14px;
  }
}

@media (max-width: 320px) {
  .filter-tabs {
    width: 100%;
    justify-content: center;
  }
  
  .order-item-meta {
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
  }
  
  .order-item-total {
    text-align: left;
    min-width: auto;
  }
  
  .signout-card h1 {
    font-size: 20px;
  }
}
/* ========== MOBILE RESPONSIVE FOR ORDERS SECTION ========== */
@media (max-width: 768px) {
  .orders-section {
    padding: 20px 16px;
  }
  
  .section-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
    margin-bottom: 20px;
  }
  
  .section-header h2 {
    font-size: 16px;
  }
  
  .filter-tabs {
    width: 100%;
    overflow-x: auto;
    padding-bottom: 8px;
    margin-bottom: -8px;
    flex-wrap: nowrap;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }
  
  .filter-tabs::-webkit-scrollbar {
    display: none;
  }
  
  .filter-tab {
    padding: 6px 14px;
    font-size: 10px;
    white-space: nowrap;
  }
  
  .order-group {
    margin-bottom: 16px;
    border-radius: 16px;
  }
  
  .order-group-header {
    padding: 14px 16px;
    flex-direction: column;
    align-items: flex-start;
    gap: 10px;
  }
  
  .order-group-info {
    width: 100%;
    flex-wrap: wrap;
    gap: 10px;
  }
  
  .order-group-id {
    font-size: 11px;
    width: 100%;
  }
  
  .order-group-date {
    font-size: 10px;
    margin-right: auto;
  }
  
  .order-group-status {
    font-size: 9px;
    padding: 3px 10px;
  }
  
  .order-group-total {
    font-size: 13px;
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .order-group-total span {
    font-size: 14px;
  }
  
  .order-items {
    padding: 12px 16px;
    gap: 12px;
  }
  
  .order-item {
    padding: 10px;
    gap: 12px;
    flex-wrap: wrap;
  }
  
  .order-item-img {
    width: 50px;
    height: 65px;
  }
  
  .order-item-details {
    flex: 1;
    min-width: calc(100% - 62px);
    flex-wrap: wrap;
    gap: 8px;
  }
  
  .order-item-info {
    width: 100%;
  }
  
  .order-item-info h4 {
    font-size: 11px;
    margin-bottom: 4px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 180px;
  }
  
  .order-item-info .item-price {
    font-size: 10px;
  }
  
  .order-item-meta {
    width: 100%;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
  }
  
  .order-item-quantity {
    font-size: 10px;
    padding: 3px 8px;
  }
  
  .order-item-total {
    font-size: 11px;
    min-width: auto;
    font-weight: 600;
  }
  
  .order-group-footer {
    padding: 14px 16px;
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
  }
  
  .order-summary {
    width: 100%;
    justify-content: space-between;
    gap: 12px;
  }
  
  .order-summary-item {
    font-size: 10px;
  }
  
  .btn-track {
    width: 100%;
    padding: 12px 20px;
    font-size: 10px;
    justify-content: center;
  }
  
  .btn-track i {
    font-size: 11px;
  }
  
  /* Stats cards mobile */
  .stats-grid {
    gap: 12px;
    margin-bottom: 32px;
  }
  
  .stat-card {
    padding: 18px;
    gap: 12px;
  }
  
  .stat-icon {
    width: 40px;
    height: 40px;
  }
  
  .stat-icon i {
    font-size: 18px;
  }
  
  .stat-info h3 {
    font-size: 18px;
  }
  
  .stat-info p {
    font-size: 11px;
  }
  
  /* Welcome banner mobile */
  .welcome-banner {
    padding: 24px 20px;
    margin-bottom: 32px;
  }
  
  .welcome-content {
    gap: 16px;
  }
  
  .profile-image-large {
    width: 60px;
    height: 60px;
  }
  
  .welcome-text h1 {
    font-size: 20px;
  }
  
  .welcome-text .user-email {
    font-size: 12px;
  }
  
  .welcome-actions {
    width: 100%;
    flex-direction: row;
    justify-content: stretch;
  }
  
  .welcome-actions a,
  .welcome-actions button {
    flex: 1;
    justify-content: center;
    padding: 12px 16px;
    font-size: 10px;
  }
  
  /* No orders state mobile */
  .no-orders {
    padding: 40px 16px;
  }
  
  .no-orders-icon {
    width: 60px;
    height: 60px;
  }
  
  .no-orders-icon i {
    font-size: 24px;
  }
  
  .no-orders h3 {
    font-size: 16px;
  }
  
  .no-orders p {
    font-size: 12px;
    margin-bottom: 24px;
  }
  
  .btn-shop-large {
    padding: 14px 28px;
    font-size: 11px;
  }
}

/* Extra small devices */
@media (max-width: 480px) {
  .orders-section {
    padding: 16px 12px;
  }
  
  .order-group-header {
    padding: 12px 14px;
  }
  
  .order-group-info {
    gap: 8px;
  }
  
  .order-group-id {
    font-size: 10px;
  }
  
  .order-group-date {
    font-size: 9px;
  }
  
  .order-group-status {
    font-size: 8px;
    padding: 2px 8px;
  }
  
  .order-group-total {
    font-size: 12px;
  }
  
  .order-group-total span {
    font-size: 13px;
  }
  
  .order-items {
    padding: 10px 12px;
    gap: 10px;
  }
  
  .order-item {
    padding: 8px;
  }
  
  .order-item-img {
    width: 45px;
    height: 60px;
  }
  
  .order-item-info h4 {
    font-size: 10px;
    max-width: 150px;
  }
  
  .order-item-info .item-price {
    font-size: 9px;
  }
  
  .order-item-quantity {
    font-size: 9px;
    padding: 2px 6px;
  }
  
  .order-item-total {
    font-size: 10px;
  }
  
  .order-group-footer {
    padding: 12px 14px;
  }
  
  .order-summary-item {
    font-size: 9px;
  }
  
  .btn-track {
    padding: 10px 16px;
    font-size: 9px;
  }
  
  .stats-grid {
    grid-template-columns: 1fr;
    gap: 10px;
  }
  
  .stat-card {
    padding: 16px;
  }
  
  .welcome-banner {
    padding: 20px 16px;
  }
  
  .profile-image-large {
    width: 50px;
    height: 50px;
  }
  
  .welcome-text h1 {
    font-size: 18px;
  }
  
  .welcome-text .user-email {
    font-size: 11px;
    flex-wrap: wrap;
  }
  
  .welcome-actions {
    flex-direction: column;
  }
  
  .welcome-actions a,
  .welcome-actions button {
    width: 100%;
  }
}

/* Very small devices */
@media (max-width: 360px) {
  .order-item-details {
    min-width: 100%;
  }
  
  .order-item-meta {
    flex-wrap: wrap;
    gap: 6px;
  }
  
  .order-item-quantity {
    width: 100%;
    text-align: center;
  }
  
  .order-item-total {
    width: 100%;
    text-align: center;
  }
  
  .filter-tab {
    padding: 5px 10px;
    font-size: 9px;
  }
  
  .order-group-info {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .order-summary {
    flex-direction: column;
    align-items: flex-start;
    gap: 6px;
  }
}
/* ========== KEEP USER EMAIL LEFT-ALIGNED ON MOBILE ========== */
@media (max-width: 768px) {
  .welcome-text .user-email {
    justify-content: center !important;
    text-align: left !important;
  }
}

/* For extra small devices */
@media (max-width: 480px) {
  .welcome-text .user-email {
    justify-content: center !important;
    text-align: left !important;
  }
}

/* For very small devices */
@media (max-width: 360px) {
  .welcome-text .user-email {
    justify-content: center !important;
    text-align: left !important;
  }
}
</style>
</head>
<body>
<!-- ==================== HEADER ==================== -->
<header class="header" id="mainHeader">
  <div class="header-inner">
    <nav class="nav-left">
      <a href="products.html" class="nav-link btn-text">Shop All</a>
      <button class="mobile-menu-btn btn-text" onclick="openMenu()">
        <i class="fas fa-bars"></i> Menu
      </button>
    </nav>
    <div style="position: absolute; left: 50%; top: 50%; transform: translate(-43%, -50%);">
      <a href="products.html" class="logo" style="position: static; transform: none; margin: 0;">
        <svg viewBox="0 0 200 28" width="120">
          <text x="0" y="22" font-family="Inter" font-weight="400" font-size="26" letter-spacing="8" fill="currentColor">DIGINESS</text>
        </svg>
      </a>
    </div>
    <nav class="nav-right">
      <button class="nav-link btn-text desktop-only" onclick="openSearch()"><i class="fas fa-search"></i> Search</button>
      <a href="#about" class="nav-link btn-text desktop-only"><i class="fas fa-info-circle"></i> About</a>
      <a href="account.html" class="nav-link btn-text desktop-only"><i class="fas fa-user"></i> Account</a>
      <button class="nav-link btn-text bag" onclick="openBag()">
        <i class="fas fa-shopping-bag"></i> Bag <span class="bag-count" id="bagCount">0</span>
      </button>
    </nav>
  </div>
</header>

<!-- ==================== MENU SIDEBAR ==================== -->
<div class="menu-overlay" id="menuOverlay" onclick="closeMenu()"></div>
<div class="menu-sidebar" id="menuSidebar">
  <div class="menu-header">
    <h3>DIGINESS</h3>
    <button class="menu-close btn-text" onclick="closeMenu()"><i class="fas fa-times"></i> Close</button>
  </div>
  <div class="menu-body">
    <div class="mobile-search-item" onclick="openSearch(); closeMenu();">
      <span><i class="fas fa-search"></i> Search</span>
      <span class="mobile-search-icon"><i class="fas fa-arrow-right"></i></span>
    </div>
    <a href="products.html" class="menu-item" onclick="closeMenu()"><i class="fas fa-store"></i> Shop All</a>
    <a href="account.html" class="menu-item" onclick="closeMenu()"><i class="fas fa-user"></i> Account</a>
    <a href="#about" class="menu-item" onclick="closeMenu()"><i class="fas fa-info-circle"></i> About</a>
    <div class="menu-divider"></div>
    <a href="#" class="menu-item" onclick="closeMenu()"><i class="fas fa-truck"></i> Shipping & Returns</a>
  </div>
</div>

<!-- ==================== SEARCH OVERLAY ==================== -->
<div class="search-overlay" id="searchOverlay">
  <button class="search-close" onclick="closeSearch()"><i class="fas fa-times"></i></button>
  <div class="search-input-wrapper">
    <input type="text" placeholder="Search smart gadgets..." id="searchInput" oninput="handleSearch()">
    <span class="search-icon"><i class="fas fa-search"></i></span>
  </div>
  <div class="search-results" id="searchResults"></div>
</div>

<!-- ==================== BAG SIDEBAR ==================== -->
<div class="bag-overlay" id="bagOverlay" onclick="closeBag()"></div>
<div class="bag-sidebar" id="bagSidebar">
  <div class="bag-header">
    <h3><i class="fas fa-shopping-bag"></i> Your Bag</h3>
    <button class="bag-close btn-text" onclick="closeBag()"><i class="fas fa-times"></i> Close</button>
  </div>
  <div class="bag-body" id="bagBody">
    <div class="bag-empty">Your bag is empty</div>
  </div>
  <div class="bag-footer" id="bagFooter"></div>
</div>

<!-- ==================== TRACK MODAL ==================== -->
<div class="track-modal" id="trackModal">
  <div class="track-modal-content">
    <button class="modal-close" onclick="closeTrackModal()"><i class="fas fa-times"></i></button>
    <div class="modal-icon">
      <i class="fas fa-truck"></i>
    </div>
    <h3 class="modal-title">Track Your Order</h3>
    <div class="modal-message">
      We'll notify you as soon as your order ships. Stay tuned!
    </div>
    <div class="modal-order-info" id="modalOrderInfo">
      <div class="modal-order-row">
        <span class="modal-order-label">Order ID</span>
        <span class="modal-order-value" id="modalOrderId">DIG-2024-001</span>
      </div>
      <div class="modal-order-row">
        <span class="modal-order-label">Status</span>
        <span class="modal-order-status-badge" id="modalOrderStatus">Processing</span>
      </div>
      <div class="modal-order-row">
        <span class="modal-order-label">Expected</span>
        <span class="modal-order-value" id="modalOrderDate">5-7 business days</span>
      </div>
    </div>
    <button class="modal-btn" onclick="closeTrackModal()">
      <i class="fas fa-check"></i> Got It
    </button>
  </div>
</div>

<!-- ==================== MAIN ACCOUNT CONTENT ==================== -->
<div class="account-page" id="accountPage">
  <!-- Content will be injected by JavaScript -->
</div>

<!-- ==================== FOOTER ==================== -->
<footer class="footer" id="about">
  <div class="footer-inner">
    <div>
      <h3>Stay Connected</h3>
      <p>Sign up for exclusive access to new gadgets, special offers, and stories from the world of Diginess.</p>
      <div class="footer-input">
        <input type="email" placeholder="Email address">
        <button><i class="fas fa-arrow-right"></i></button>
      </div>
    </div>
    <div>
      <h3>Shop</h3>
      <ul>
        <li><a href="products.html">Smart Watch Pro</a></li>
        <li><a href="products.html">Wireless Earbuds X1</a></li>
        <li><a href="products.html">Mini Drone Cam</a></li>
        <li><a href="products.html">Shop All</a></li>
      </ul>
    </div>
    <div>
      <h3>Info</h3>
      <ul>
        <li><a href="#">Our Approach</a></li>
        <li><a href="#">Contact</a></li>
        <li><a href="#">Shipping & Returns</a></li>
        <li><a href="#">Privacy Policy</a></li>
        <li><a href="#">Terms of Service</a></li>
      </ul>
    </div>
  </div>
  <div class="footer-bottom">
    <div class="footer-socials">
      <a href="#"><i class="fab fa-instagram"></i> Instagram</a>
      <a href="#"><i class="fab fa-tiktok"></i> TikTok</a>
      <a href="#"><i class="fab fa-youtube"></i> YouTube</a>
    </div>
    <span>© 2026 Diginess. All rights reserved.</span>
  </div>
</footer>

<!-- Firebase config -->
<script>
  // ------------------ FIREBASE CONFIG ------------------
  const firebaseConfig = {
    apiKey: "AIzaSyDajOB6BPahP6gPjtT-YTh7-9gdlKCqGiU",
    authDomain: "diginess-store.firebaseapp.com",
    projectId: "diginess-store",
    storageBucket: "diginess-store.firebasestorage.app",
    messagingSenderId: "549723461376",
    appId: "1:549723461376:web:dab9f5b8e9decd105385e5",
    measurementId: "G-EXKHB5B23X"
  };
  
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  // ------------------ GLOBAL VARIABLES ------------------
  let bagItems = [];
  let currentUser = null;
  let orders = [];
  let currentFilter = 'all';

  // ========== SEARCH FUNCTIONALITY ==========
  window.handleSearch = function() {
    const query = document.getElementById('searchInput')?.value.toLowerCase().trim();
    const resultsContainer = document.getElementById('searchResults');
    
    if (!resultsContainer) return;
    
    if (!query) {
      resultsContainer.innerHTML = '';
      return;
    }

    if (typeof productData === 'undefined' || !productData.length) {
      resultsContainer.innerHTML = '<div class="no-results">Loading products...</div>';
      return;
    }

    const matches = productData.filter(product => 
      product.name.toLowerCase().includes(query)
    );

    if (matches.length > 0) {
      resultsContainer.innerHTML = matches.map(product => `
        <div class="search-result-item" onclick="selectProduct('${product.slug}')">
          <div style="display: flex; align-items: center; gap: 12px;">
            <img src="${product.img}" alt="${product.name}" style="width: 40px; height: 40px; object-fit: cover; border-radius: 4px;">
            <div>
              <div style="font-size: 14px; color: #fff;">${product.name}</div>
              <div style="font-size: 12px; color: var(--primary);">${product.price}</div>
            </div>
          </div>
        </div>
      `).join('');
    } else {
      resultsContainer.innerHTML = '<div class="no-results">No products found</div>';
    }
  };

  window.selectProduct = function(slug) {
    window.location.href = 'product-detail.html?product=' + slug;
    closeSearch();
  };

  // Sync bagItems with localStorage on load
  window.addEventListener('load', function() {
    const savedBag = localStorage.getItem('diginess_bag');
    if (savedBag) {
      try {
        bagItems = JSON.parse(savedBag);
        updateBagUI();
      } catch (e) {
        console.error('Error parsing bag:', e);
      }
    }
  });

  // ------------------ BAG FUNCTIONS ------------------
  const bagCountSpan = document.getElementById('bagCount');
  const bagBody = document.getElementById('bagBody');
  const bagFooter = document.getElementById('bagFooter');

  function updateBagUI() {
    if (!bagBody) return;
    if (bagItems.length === 0) {
      bagBody.innerHTML = '<div class="bag-empty">Your bag is empty</div>';
      bagFooter.innerHTML = '';
      bagCountSpan.innerText = '0';
      return;
    }
    let html = '';
    let total = 0;
    bagItems.forEach((item, idx) => {
      const priceNum = parseInt(item.price.replace(/[^0-9]/g,'')) || 0;
      total += priceNum * (item.quantity || 1);
      html += `
        <div class="bag-item">
          <img src="${item.img}" alt="${item.name}">
          <div class="bag-item-info">
            <span class="bag-item-title">${item.name}</span>
            <span class="bag-item-price">${item.price}</span>
            <div class="bag-quantity" style="display:flex; gap:8px; margin:8px 0;">
              <button class="bag-qty-btn" onclick="changeQty(${idx}, -1)">−</button>
              <span class="bag-qty-num">${item.quantity || 1}</span>
              <button class="bag-qty-btn" onclick="changeQty(${idx}, 1)">+</button>
            </div>
            <span class="bag-item-remove" onclick="removeFromBag(${idx})">Remove</span>
          </div>
        </div>
      `;
    });
    bagBody.innerHTML = html;
    bagFooter.innerHTML = `
      <div class="bag-total"><span>TOTAL</span><span>₹${total.toLocaleString()}</span></div>
      <button class="btn-primary" onclick="checkout()">CHECKOUT</button>
    `;
    bagCountSpan.innerText = bagItems.length;
  }

  window.addToBag = (name, price, img) => {
    const existing = bagItems.find(item => item.name === name);
    if (existing) {
      existing.quantity = (existing.quantity || 1) + 1;
    } else {
      bagItems.push({ name, price, img, quantity: 1 });
    }
    
    localStorage.setItem('diginess_bag', JSON.stringify(bagItems));
    updateBagUI();
    openBag();
  };

  window.changeQty = (idx, delta) => {
    if (!bagItems[idx]) return;
    const newQty = (bagItems[idx].quantity || 1) + delta;
    if (newQty < 1) {
      removeFromBag(idx);
    } else {
      bagItems[idx].quantity = newQty;
      localStorage.setItem('diginess_bag', JSON.stringify(bagItems));
      updateBagUI();
    }
  };

  window.removeFromBag = (idx) => { 
    bagItems.splice(idx,1); 
    localStorage.setItem('diginess_bag', JSON.stringify(bagItems));
    updateBagUI(); 
  };

  window.checkout = () => {
    if (!auth.currentUser) {
      showSignInPrompt();
      return;
    }
    localStorage.setItem('diginess_bag', JSON.stringify(bagItems));
    window.location.href = 'checkout.html';
  };

  function showSignInPrompt() {
    const prompt = document.createElement('div');
    prompt.className = 'signin-prompt';
    prompt.style.cssText = `
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      background: #1a1a1a;
      border: 1px solid var(--primary);
      border-radius: 12px;
      padding: 16px 24px;
      display: flex;
      align-items: center;
      gap: 16px;
      z-index: 1000;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      backdrop-filter: blur(10px);
      animation: slideUp 0.3s ease;
    `;
    prompt.innerHTML = `
      <span style="color: #fff; font-size: 13px;">Please sign in to checkout</span>
      <a href="account.html" style="
        background: var(--primary);
        color: #000;
        padding: 8px 16px;
        border-radius: 40px;
        font-size: 11px;
        text-decoration: none;
        font-weight: 500;
      ">Sign In</a>
    `;
    document.body.appendChild(prompt);
    setTimeout(() => prompt.remove(), 3000);
  }

  // ------------------ HEADER CONTROLS ------------------
  window.openMenu = () => {
    document.getElementById('menuSidebar').classList.add('active');
    document.getElementById('menuOverlay').classList.add('active');
  };
  
  window.closeMenu = () => {
    document.getElementById('menuSidebar').classList.remove('active');
    document.getElementById('menuOverlay').classList.remove('active');
  };
  
  window.openSearch = () => {
    document.getElementById('searchOverlay').classList.add('active');
    setTimeout(() => document.getElementById('searchInput')?.focus(), 100);
  };
  
  window.closeSearch = () => {
    document.getElementById('searchOverlay').classList.remove('active');
    document.getElementById('searchInput').value = '';
    document.getElementById('searchResults').innerHTML = '';
  };
  
  window.openBag = () => {
    document.getElementById('bagSidebar').classList.add('active');
    document.getElementById('bagOverlay').classList.add('active');
    updateBagUI();
  };
  
  window.closeBag = () => {
    document.getElementById('bagSidebar').classList.remove('active');
    document.getElementById('bagOverlay').classList.remove('active');
  };

  // ------------------ TRACK MODAL FUNCTIONS ------------------
  window.openTrackModal = (orderId, status = 'Processing') => {
    const modal = document.getElementById('trackModal');
    const modalOrderId = document.getElementById('modalOrderId');
    const modalOrderStatus = document.getElementById('modalOrderStatus');
    
    if (modalOrderId) modalOrderId.textContent = orderId;
    if (modalOrderStatus) modalOrderStatus.textContent = status;
    
    modal.classList.add('active');
  };

  window.closeTrackModal = () => {
    document.getElementById('trackModal').classList.remove('active');
  };

  // ------------------ LOAD ORDERS FROM FIRESTORE ------------------
  async function loadUserOrders(user) {
    if (!user) return [];
    
    try {
      console.log('Loading orders for user:', user.uid);
      
      // Get orders from Firestore
      const ordersRef = db.collection('orders')
        .where('userId', '==', user.uid);
      
      const snapshot = await ordersRef.get();
      
      if (snapshot.empty) {
        console.log('No orders found for user');
        return [];
      }
      
      console.log(`Found ${snapshot.size} orders`);
      const orders = [];
      snapshot.forEach(doc => {
        const data = doc.data();
        console.log('Order data:', data);
        
        // Format the order properly
        orders.push({
          id: doc.id,
          orderId: data.orderId || data.id || doc.id,
          date: data.date || new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }),
          items: Array.isArray(data.items) ? data.items : [],
          total: data.total || 0,
          status: data.status || 'Processing',
          createdAt: data.createdAt
        });
      });
      
      // Sort by date (newest first)
      orders.sort((a, b) => {
        if (a.createdAt && b.createdAt) {
          return b.createdAt.seconds - a.createdAt.seconds;
        }
        return 0;
      });
      
      return orders;
      
    } catch (error) {
      console.error('Error loading orders:', error);
      return [];
    }
  }

  // Create sample orders for demo (only if no orders exist)
  async function createSampleOrders(user) {
    const sampleOrders = [
      {
        userId: user.uid,
        userEmail: user.email,
        orderId: 'DIG-' + Math.floor(Math.random() * 1000),
        date: new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }),
        items: [
          { 
            name: 'Smart Watch Pro', 
            quantity: 1, 
            price: '₹16,999',
            priceNum: 16999,
            img: 'https://images.pexels.com/photos/437037/pexels-photo-437037.jpeg?w=100&h=100&fit=crop'
          }
        ],
        total: 16999,
        status: 'Processing',
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      },
      {
        userId: user.uid,
        userEmail: user.email,
        orderId: 'DIG-' + Math.floor(Math.random() * 1000),
        date: new Date(Date.now() - 5*24*60*60*1000).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }),
        items: [
          { 
            name: 'Wireless Earbuds X1', 
            quantity: 2, 
            price: '₹9,999',
            priceNum: 9999,
            img: 'https://images.pexels.com/photos/3780681/pexels-photo-3780681.jpeg?w=100&h=100&fit=crop'
          }
        ],
        total: 19998,
        status: 'Shipped',
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      }
    ];

    const batch = db.batch();
    sampleOrders.forEach(order => {
      const docRef = db.collection('orders').doc();
      batch.set(docRef, order);
    });
    
    await batch.commit();
  }

  // ------------------ RENDER ACCOUNT PAGE ------------------
  async function renderAccountPage(user) {
    const container = document.getElementById('accountPage');
    
    if (!user) {
      // SIGNED OUT STATE - Beautiful sign-in card
      container.innerHTML = `
        <div class="signout-container">
          <div class="signout-card">
            <div class="signout-icon">
              <i class="fas fa-user-circle"></i>
            </div>
            
            <h1>ACCOUNT</h1>
            <p>Sign in to view your orders, track shipments, and manage your account</p>
            
            <button class="google-signin-btn" id="googleLoginBtn">
              <i class="fab fa-google"></i>
              Continue with Google
            </button>
            
            <div class="signout-divider">BENEFITS</div>
            
            <div class="signout-features">
              <div class="feature-item">
                <i class="fas fa-truck"></i>
                <span>Track Orders</span>
              </div>
              <div class="feature-item">
                <i class="fas fa-history"></i>
                <span>Order History</span>
              </div>
              <div class="feature-item">
                <i class="fas fa-tag"></i>
                <span>Exclusive Offers</span>
              </div>
            </div>
            
            <div class="signout-footer">
              New customer? <a href="products.html">Start Shopping</a>
            </div>
            
            <div id="authMessage" class="auth-message"></div>
          </div>
        </div>
      `;
      
      document.getElementById('googleLoginBtn')?.addEventListener('click', googleLogin);
      return;
    }

    // Show loading state
    container.innerHTML = `
      <div class="loading-orders">
        <i class="fas fa-circle-notch"></i>
        <p>Loading your account...</p>
      </div>
    `;

    // Load orders from Firestore
    const userOrders = await loadUserOrders(user);
    orders = userOrders;
    console.log('Orders loaded:', orders);

    // Calculate stats
    const totalOrders = orders.length;
    const totalSpent = orders.reduce((sum, order) => sum + (order.total || 0), 0);
    const pendingOrders = orders.filter(o => o.status === 'Processing' || o.status === 'Pending').length;

    // Filter orders based on current filter
    const filteredOrders = currentFilter === 'all' 
      ? orders 
      : orders.filter(o => o.status?.toLowerCase() === currentFilter.toLowerCase());

    // Generate orders HTML
    let ordersHTML = '';
    
    if (filteredOrders.length === 0) {
      ordersHTML = `
        <div class="no-orders">
          <div class="no-orders-icon">
            <i class="fas fa-box-open"></i>
          </div>
          <h3>No orders found</h3>
          <p>Looks like you haven't placed any orders yet. Start exploring our collection!</p>
          <a href="products.html" class="btn-shop-large">
            <i class="fas fa-store"></i> Shop Now
          </a>
        </div>
      `;
    } else {
      ordersHTML = filteredOrders.map(order => {
        const items = Array.isArray(order.items) ? order.items : [];
        const itemCount = items.length;
        
        return `
          <div class="order-group">
            <div class="order-group-header">
              <div class="order-group-info">
                <span class="order-group-id">Order #${order.orderId || order.id}</span>
                <span class="order-group-date">
                  <i class="far fa-calendar"></i> ${order.date || 'Recent order'}
                </span>
                <span class="order-group-status">${order.status}</span>
              </div>
              <span class="order-group-total">
                Total: <span>₹${(order.total || 0).toLocaleString()}</span>
              </span>
            </div>
            
            <div class="order-items">
              ${items.map(item => {
                const itemPrice = item.priceNum || parseInt(String(item.price).replace(/[^0-9]/g, '')) || 0;
                const itemTotal = itemPrice * (item.quantity || 1);
                
                return `
                  <div class="order-item">
                    <img src="${item.img || 'https://via.placeholder.com/100'}" alt="${item.name}" class="order-item-img">
                    <div class="order-item-details">
                      <div class="order-item-info">
                        <h4>${item.name}</h4>
                        <span class="item-price">${item.price || '₹' + itemPrice.toLocaleString()}</span>
                      </div>
                      <div class="order-item-meta">
                        <span class="order-item-quantity">Qty: ${item.quantity || 1}</span>
                        <span class="order-item-total">₹${itemTotal.toLocaleString()}</span>
                      </div>
                    </div>
                  </div>
                `;
              }).join('')}
            </div>
            
            <div class="order-group-footer">
              <div class="order-summary">
                <span class="order-summary-item">
                  <i class="fas fa-box"></i> ${itemCount} item(s)
                </span>
              </div>
              <button class="btn-track" onclick="openTrackModal('${order.orderId || order.id}', '${order.status}')">
                <i class="fas fa-truck"></i> Track Order
              </button>
            </div>
          </div>
        `;
      }).join('');
    }

    // Complete page HTML
    container.innerHTML = `
      <!-- Welcome Banner -->
      <div class="welcome-banner">
        <div class="welcome-content">
          ${user.photoURL ? 
            `<img src="${user.photoURL}" alt="Profile" class="profile-image-large">` : 
            `<div class="profile-image-large" style="display: flex; align-items: center; justify-content: center; background: #2a2a2a;">
              <i class="fas fa-user" style="font-size: 40px; color: #666;"></i>
            </div>`
          }
          <div class="welcome-text">
            <h1>Welcome back, ${user.displayName || 'Customer'}!</h1>
            <div class="user-email">
              <i class="fas fa-envelope"></i> ${user.email}
            </div>
          </div>
        </div>
        <div class="welcome-actions">
          <a href="products.html" class="btn-primary-white">
            <i class="fas fa-store"></i> Shop
          </a>
          <button class="btn-outline-light" onclick="refreshOrders()">
            <i class="fas fa-sync-alt"></i> Refresh
          </button>
          <button class="btn-outline-light" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i> Sign Out
          </button>
        </div>
      </div>

      <!-- Stats Cards -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon">
            <i class="fas fa-box"></i>
          </div>
          <div class="stat-info">
            <h3>${totalOrders}</h3>
            <p>Total Orders</p>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">
            <i class="fas fa-truck"></i>
          </div>
          <div class="stat-info">
            <h3>${pendingOrders}</h3>
            <p>Pending</p>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">
            <i class="fas fa-rupee-sign"></i>
          </div>
          <div class="stat-info">
            <h3>₹${totalSpent.toLocaleString()}</h3>
            <p>Total Spent</p>
          </div>
        </div>
      </div>

      <!-- Orders Section -->
      <div class="orders-section">
        <div class="section-header">
          <h2><i class="fas fa-shopping-bag"></i> Your Orders</h2>
          <div class="filter-tabs">
            <button class="filter-tab ${currentFilter === 'all' ? 'active' : ''}" onclick="filterOrders('all')">All</button>
            <button class="filter-tab ${currentFilter === 'processing' ? 'active' : ''}" onclick="filterOrders('processing')">Processing</button>
            <button class="filter-tab ${currentFilter === 'shipped' ? 'active' : ''}" onclick="filterOrders('shipped')">Shipped</button>
            <button class="filter-tab ${currentFilter === 'delivered' ? 'active' : ''}" onclick="filterOrders('delivered')">Delivered</button>
          </div>
        </div>
        
        <div class="orders-list">
          ${ordersHTML}
        </div>
      </div>
    `;
  }

  // ------------------ REFRESH ORDERS ------------------
  window.refreshOrders = async function() {
    if (!currentUser) return;
    
    const container = document.getElementById('accountPage');
    container.innerHTML = `
      <div class="loading-orders">
        <i class="fas fa-circle-notch"></i>
        <p>Refreshing your orders...</p>
      </div>
    `;
    
    const userOrders = await loadUserOrders(currentUser);
    orders = userOrders;
    renderAccountPage(currentUser);
  };

  // ------------------ FILTER ORDERS ------------------
  window.filterOrders = (filter) => {
    currentFilter = filter;
    renderAccountPage(auth.currentUser);
  };

  // ------------------ AUTH FUNCTIONS ------------------
  async function googleLogin() {
    const provider = new firebase.auth.GoogleAuthProvider();
    try {
      await auth.signInWithPopup(provider);
    } catch (err) {
      const msgDiv = document.getElementById('authMessage');
      if (msgDiv) msgDiv.innerText = 'Login failed: ' + err.message;
    }
  }

  window.logout = async () => {
    await auth.signOut();
    currentFilter = 'all';
    renderAccountPage(null);
  };

  // ------------------ DEBUG FUNCTION ------------------
  window.debugOrders = async function() {
    if (!auth.currentUser) {
      alert('Please sign in first');
      return;
    }
    
    console.log('=== DEBUGGING ORDERS ===');
    console.log('User ID:', auth.currentUser.uid);
    console.log('User Email:', auth.currentUser.email);
    
    try {
      const snapshot = await db.collection('orders')
        .where('userId', '==', auth.currentUser.uid)
        .get();
      
      console.log(`Found ${snapshot.size} orders:`);
      snapshot.forEach(doc => {
        console.log('Document ID:', doc.id);
        console.log('Order data:', doc.data());
      });
      
      if (snapshot.size > 0) {
        alert(`Found ${snapshot.size} orders. Check console for details.`);
        window.location.reload();
      } else {
        alert('No orders found in database for this user.');
      }
      
    } catch (error) {
      console.error('Debug error:', error);
      alert('Error: ' + error.message);
    }
  };

  // ------------------ AUTH STATE LISTENER ------------------
  auth.onAuthStateChanged(async (user) => {
    currentUser = user;
    console.log('Auth state changed:', user ? user.email : 'logged out');
    await renderAccountPage(user);
  });

  // Close modal on Escape key
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      closeTrackModal();
      closeSearch();
      closeBag();
      closeMenu();
    }
  });

  // Close modal when clicking outside
  document.getElementById('trackModal')?.addEventListener('click', function(e) {
    if (e.target === this) {
      closeTrackModal();
    }
  });

  // Close overlays when clicking on overlay
  document.getElementById('menuOverlay')?.addEventListener('click', closeMenu);
  document.getElementById('bagOverlay')?.addEventListener('click', closeBag);
</script>
</body>
</html>